Sub stock_data2()  Dim StockName As String  Dim prevSName As String  Dim VolumeTotal As Double  BrandTotal = 0  ' row index in summary table  Dim SumRow As Integer  SumRow = 2  ' Loop through all credit card purchases  Dim lastRow As Double  lastRow = Cells(Rows.Count, 1).End(xlUp).Row  Debug.Print (lastRow)  prevBrand = Cells(2, 1).Value  For i = 2 To lastRow + 1    StockName = Cells(i, 1).Value    Debug.Print (i)    If StockName = prevSName Then      'Add to the Brand Total      VolumeTotal = VolumeTotal + Cells(i, 7).Value    Else      ' Print the Credit Card Brand in the Summary Table      Range("SumTable14").Cells(SumRow, 1).Value = prevSName      ' Print the Brand Amount to the Summary Table      Range("SumTable14").Cells(SumRow, 2).Value = VolumeTotal      ' Add one to the summary table row      SumRow = SumRow + 1      ' Start the new Brand Total      VolumeTotal = Cells(i, 7).Value      prevSName = StockName    End If  Next iEnd Sub  